#main.py

import scanner

# New test web app URL
target_url = "http://localhost:8080/testapp/"
links_to_ignore = ["http://localhost:8080/testapp/logout"]

# Adjusted login form fields
data_dict = {
    "user": "testuser",
    "pass": "testpass",
    "submit": "Login"
}

# Instantiate and configure the scanner
vuln_scanner = scanner.Scanner(target_url, links_to_ignore)

# Simulate login
vuln_scanner.session.post("http://localhost:8080/testapp/login", data=data_dict)

# Start crawling and scanning
vuln_scanner.crawl()
vuln_scanner.run_scanner()
